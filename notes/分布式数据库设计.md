### 最简单的数据库

``` bash
#!/bin/bash

db_set （）{
    echo "$1,$2" >> database.txt
}

db_get （）{
    grep "~$1" database.txt | sed "s/~$1,//" | tail -n 1
}   

echo "test"
db_set "test" "test"
db_get "test"

echo "test json value"
db_set "test json value" "{\"name\":\"test\",\"age\":18}"
db_get "test json value"

cat database.txt
```

考虑复杂的问题：
- 并发控制
- 回收磁盘空间
- 控制日志文件大小
- 处理错误
- 部分完成写记录

问题：
- 日志保存了大量的记录，`db_get`的性能非常差, 每次查找，都需要从头到尾扫描整个数据库文件找到key的位置。开销是O(n).

所以，为了高效的查找Key, 需要引入索引。
- 写入，除了追加，还要更新索引。所以索引会降低写入的效率。所以通常不会对所有内容进行索引。



